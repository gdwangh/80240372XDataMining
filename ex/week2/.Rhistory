g <- g + labs(x = "pvals", y = "coverage")
g
n <- 200000
pvals <- seq(0.1, 0.9, by = 0.05)
nosim <- 1000
coverage <- sapply(pvals, function(p) {
phats <- rbinom(nosim, prob = p, size = n)/n
ll <- phats - qnorm(0.975) * sqrt(phats * (1 - phats)/n)
ul <- phats + qnorm(0.975) * sqrt(phats * (1 - phats)/n)
mean(ll < p & ul > p)
})
library(ggplot2)
g <- ggplot(data.frame(x = pvals, y = coverage), aes(x = x, y = y))
g <- g + geom_hline(yintercept = 0.75) + geom_line(size = 2)
g <- g + labs(x = "pvals", y = "coverage")
g
n <- 200
pvals <- seq(0.1, 0.9, by = 0.05)
nosim <- 1000
coverage <- sapply(pvals, function(p) {
phats <- rbinom(nosim, prob = p, size = n)/n
ll <- phats - qnorm(0.975) * sqrt(phats * (1 - phats)/n)
ul <- phats + qnorm(0.975) * sqrt(phats * (1 - phats)/n)
mean(ll < p & ul > p)
})
library(ggplot2)
g <- ggplot(data.frame(x = pvals, y = coverage), aes(x = x, y = y))
g <- g + geom_hline(yintercept = 0.75) + geom_line(size = 2)
g <- g + labs(x = "pvals", y = "coverage")
g
n <- 20
pvals <- seq(0.1, 0.9, by = 0.05)
nosim <- 1000
coverage <- sapply(pvals, function(p) {
phats <- rbinom(nosim, prob = p, size = n)/n
ll <- phats - qnorm(0.975) * sqrt(phats * (1 - phats)/n)
ul <- phats + qnorm(0.975) * sqrt(phats * (1 - phats)/n)
mean(ll < p & ul > p)
})
library(ggplot2)
g <- ggplot(data.frame(x = pvals, y = coverage), aes(x = x, y = y))
g <- g + geom_hline(yintercept = 0.75) + geom_line(size = 2)
g <- g + labs(x = "pvals", y = "coverage")
g
x <- 5
t <- 94.32
lambda <- x/t
round(lambda + c(-1, 1) * qnorm(0.95) * sqrt(lambda/t), 3)
poisson.test(x, T = 94.32)$conf
round(lambda + c(-1, 1) * qnorm(0.975) * sqrt(lambda/t), 3)
x <- 10
t <- 1
lambda <- x/t
round(lambda + c(-1, 1) * qnorm(0.95) * sqrt(lambda/t), 3)
poisson.test(10 * 60, 60)
choice(5,4)*0.5^4*0.5+0.5^5
choose(5,4)*0.5^4*0.5+0.5^5
ppois(100, lambda = 15 )
?ppois
ppois(100, lambda = 15 )
?t.test
install.packages("swirl")
q()
library(manipulate)
library(UsingR)
data(galton)
myHist <- function(mu){
hist(galton$child,col="blue",breaks=100)
lines(c(mu, mu), c(0, 150),col="red",lwd=5)
mse <- mean((galton$child - mu)^2)
text(63, 150, paste("mu = ", mu))
text(63, 140, paste("MSE = ", round(mse, 2)))
}
manipulate(myHist(mu), mu = manipulate::slider(62, 74, step = 0.5))
manipulate(myHist(mu), mu = slider(62, 74, step = 0.5))
manipulate(myHist(mu), mu = slider(62, 74))
manipulate(myHist(mu), mu = manipulate::slider(62, 74, step = 0.5))
wirl()
swirl()
swirl()
library(swirl)
swirl()
plot(child ~ parent, galton)
"plot(jitter(child,4) ~
| parent,galton)
parent,galton)
)
q
:
"
plot(jitter(child,4) ~ parent,galton)
skip()
skip
skip()
skip()
swirl()
quit()
library(manipulate)
data(galton)
myPlot <- function(beta){
y <- galton$child - mean(galton$child)
x <- galton$parent - mean(galton$parent)
freqData <- as.data.frame(table(x, y))
names(freqData) <- c("child", "parent", "freq")
plot(
as.numeric(as.vector(freqData$parent)),
as.numeric(as.vector(freqData$child)),
pch = 21, col = "black", bg = "lightblue",
cex = .15 * freqData$freq,
xlab = "parent",
ylab = "child"
)
abline(0, beta, lwd = 3)
points(0, 0, cex = 2, pch = 19)
mse <- mean( (y - beta * x)^2 )
title(paste("beta = ", beta, "mse = ", round(mse, 3)))
}
manipulate(myPlot(beta), beta = manipulate::slider(0.4, .8, step = 0.02))
load("D:/workspace/data Analysis and Statistical inference/Data-Analysis-and-Statistical-Inference/project/gss.Rdata")
load("D:/workspace/data Analysis and Statistical inference/Data-Analysis-and-Statistical-Inference/project/gss.Rdata")
?xtabs
gc<-xtabs(Freq ~ sei, gss)
xtabs(~sei, gss)
class(gss$sei)
gss[gss$sei==17.1, ]
gss[gss$sei==17.1, c(1:10)]
names(gss)
gss[1,1]
gss[1,]
gss$sei==17.1
gss$sei
head(!is.na(gss$sei) & gss$sei==17.1)
gss[!is.na(gss$sei) & gss$sei==17.1,c(1:10)]
gss[!is.na(gss$sei) & gss$sei==17.1,sei]
gss[!is.na(gss$sei) & gss$sei==17.1,'sei']
gss[!is.na(gss$sei) & gss$sei==17.1,c(1:4,14)]
library(datasets)
load(mtcars)
boxplot(mtcars$mpg ~ mtchars$am)
data(mtcars)
boxplot(mtcars$mpg ~ mtchars$am)
boxplot(mtcars$mpg ~ mtcars$am)
?boxplot
boxplot(mtcars$mpg ~ mtcars$am, names=c("auto","manual")
)
fit1<- lm(mpg ~ factor(am), mtcars)
summary(fit1)
fit2<-lm(mpg ~ ., mtcars)
summary(fit2)
fit3<-lm(mpg ~ factor(am)+wt+hp, mtcars)
summary(fit3)
vif(fit2)
library(datasets);library(cars)
data(mtcars);data(cars)
vif(fit2)
library(car)
sqrt(vif(fit2))
vif(fit2)
fitn<-lm(mpg ~ ., mtcars)
summary(fit2)
fit2<-lm(mpg ~ factor(am)+hp+drat+qsec+vs+gear+carb, mtcars)
fit1<- lm(mpg ~ factor(am), mtcars)
summary(fit1)
fitn<-lm(mpg ~ ., mtcars)
summary(fitn)
vif(fit2)
vif(fitn)
fit2<-lm(mpg ~ factor(am)+hp+drat+qsec+vs+gear+carb, mtcars)
vif(fit2)
anova(fit1,fit2,fitn)
summary(fit2)
fit3<-lm(mpg ~ factor(am)+hp+drat+qsec+vs+gear+carb+wt, mtcars)
anova(fit1,fit2,fit3,fitn)
summary(fit3)
plot(fit3)
anova(fit1,fit2,fit3,fitn)
summary(fit2)
summary(fit2)
summary(fit3)
summary(fitn)
fit2<-lm(mpg ~ factor(am)+hp+drat+qsec+vs+gear+carb+cyl+wt, mtcars)
vif(fit2)
fit2<-lm(mpg ~ factor(am)+hp+drat+qsec+vs+gear+carb+cyl+wt, mtcars)
summary(fit2)
vif(fit2)
fit2<-lm(mpg ~ factor(am)+hp+drat+qsec+vs+gear+carb+wt, mtcars)
vif(fit3)
anova(fit1,fit2,fit3,fitn)
fit3<-lm(mpg ~ factor(am)+hp+drat+qsec+vs+gear+carb+wt, mtcars)
vif(fit3)
anova(fit1,fit2,fit3,fitn)
fit2<-lm(mpg ~ factor(am)+hp+drat+qsec+vs+gear+carb+cyl+wt, mtcars)
vif(fit2)
anova(fit1,fit3,fit2,fitn)
fit2<-lm(mpg ~ factor(am)+hp+drat+qsec+vs+gear+carb+cyl+wt, mtcars)
plot(fit2)
mtcars$am<-factor(mtcars$am)
fit1<-lm(mpg ~ am, data=mtcars)
fitn1<-lm(mpg ~ ., data=mtcars)
vif(fitn1)
fitn2<-lm(mpg~cyl+hp+drat+wt+qsec+vs+am+gear+carb)
fit2<-lm(mpg~cyl+hp+drat+wt+qsec+vs+am+gear+carb)
fit2<-lm(mpg~cyl+hp+drat+wt+qsec+vs+am+gear+carb, data=mtcars)
vif(fit2)
fit3<-lm(mpg~hp+drat+wt+qsec+vs+am+gear+carb, data=mtcars)
vif(fit3)
anova(fit1,fit2, fit3,fitn)
vif(fitn)
fit1<-lm(mpg ~ am, data=mtcars)
fitn<-lm(mpg ~ ., data=mtcars)
vif(fitn)
fit9<-lm(mpg~cyl+hp+drat+wt+qsec+vs+am+gear+carb, data=mtcars)
vif(fit9)
fit8<-lm(mpg~hp+drat+wt+qsec+vs+am+gear+carb, data=mtcars)
vif(fit8)
anova(fit1,fit8, fit9,fitn)
fitn<-fit8
par(mfrow = c(1, 1))
rng<-round(c(-1,1)*max(abs(range(resid(fitn)))), 0)
plot(predict(fitn), resid(fitn), main="Resid vs. fit", ylim=rng)
abline(h=0, col="red", lty = 3)
abline(h=4, col="red", lty = 3)
abline(h=-4, col="red", lty = 3)
par(mfrow = c(2, 2)); plot(fitn)
summary(fitn)$coefficients
fitn<-lm(mpg~am+hp+drat+wt+qsec+vs+gear+carb, data=mtcars)
summary(fitn)$coefficients
summary(fitn)$coefficients
summary(fitn)$coefficients[2]
?coef
?summary
library(datasets);library(car);data(mtcars)
cor(as.numeric(mtcars$am), mtcars[c(2:8,10:11)])
fit<-lm(mpg~as.factor(am), data=mtcars)
fti2<-lm(mpg~as.factor(am)+carb, data=mtcars)
summary(fit2)
fit2<-lm(mpg~as.factor(am)+carb, data=mtcars)
summary(fit2)
cor(as.numeric(mtcars$am), mtcars[c(2:8,10:11)])
cor(as.numeric(mtcars$carb), mtcars[c(2:8,10:11)])
vif(fit3)
fit3<-lm(mpg~as.factor(am)+carb+, data=mtcars)
fit2<-lm(mpg~as.factor(am)+carb, data=mtcars)
vif(fit2)
fitn<-lm(mpg~., data=mtcars)
summary(fit1)
summary(fit1)
fit1<-lm(mpg~as.factor(am), data=mtcars)
fit1<-lm(mpg~as.factor(am), data=mtcars)
summary(fit1)
fit2<-lm(mpg~as.factor(am)+carb, data=mtcars)
summary(fit2)
summary(fitn)
vif(fitn)
fit9<-lm(mpg~as.factor(am)+cyl+hp+drat+wt+qsec+vs+gear+carb, data=mtcars)
vif(fit9)
fit8<-lm(mpg~as.factor(am)+hp+drat+wt+qsec+vs+gear+carb, data=mtcars)
vif(fit8)
anova(fit8,fit9,fitn)
mpg$am<-as.factor(am)
mpg$am<-as.factor(mpg$am)
summary(fitn)
fit9<-lm(mpg~am+cyl+hp+drat+wt+qsec+vs+gear+carb, data=mtcars)
vif(fit9)
summary(fit9)
fit8<-lm(mpg~am+hp+drat+wt+qsec+vs+gear+carb, data=mtcars)
vif(fit8)
summary(fit8)
anova(fit8,fit9,fitn)
vif(fit8)
fit7<-lm(mpg~am+drat+wt+qsec+vs+gear+carb, data=mtcars)
anova(fit7,fit8)
vif(fit7)
fit6<-lm(mpg~am+drat+wt+qsec+vs+gear+carb, data=mtcars)
vif(fit6)
anova(fit6,fit7)
vif(fit8)
fit7<-lm(mpg~am+drat+wt+qsec+vs+gear+carb, data=mtcars)
vif(fit7)
fit6<-lm(mpg~am+drat+qsec+vs+gear+carb, data=mtcars)
anova(fit6,fit7)
summary(fit7)
fit7<-lm(mpg~am+drat+wt+qsec+vs+gear+carb, data=mtcars)
vif(fit7)
fit6<-lm(mpg~am+drat+wt+qsec+vs+carb, data=mtcars)
anova(fit6,fit7)
vif(fit6)
summary(fit6)
vif(fit6)
anova(fit6,fit7)
fit5<-lm(mpg~am+drat+wt+qsec+vs+carb, data=mtcars)
anova(fit5,fit6)
summary(fit5)
vif(fit5)
summary(fit6)
vif(fit6)
anova(fit5,fit6)
summary(fit5)
vif(fit5)
fit4<-lm(mpg~am+drat+wt+vs+carb, data=mtcars)
anova(fit4,fit5)
vif(fit4)
summary(fit4)
vif(fit4)
fit4<-lm(mpg~am+drat+wt+qsec+vs+carb, data=mtcars)
fit4<-lm(mpg~am+drat+qsec+vs+carb, data=mtcars)
anova(fit4,fit5)
vif(fit4)
summary(fit4)
fit5<-lm(mpg~am+drat+wt+qsec+vs+carb, data=mtcars)
summary(fit5)
fit4<-lm(mpg~am+drat+qsec+vs+carb, data=mtcars)
summary(fit4)
anova(fit4,fit5)
vif(fit5)
fit4<-lm(mpg~am+drat+wt+qsec+carb, data=mtcars)
anova(fit4,fit5)
fit4<-lm(mpg~am+drat+wt+qsec+carb, data=mtcars)
vif(fit4)
summary(fit4)
summary(fit5)
summary(fit4)
vif(fit4)
plot(fit4)
summary(fit4)
vif(fit4)
anova(fit4,fit5)
vif(fit4)
mtcars$am<-factor(mtcars$am)
fit1<-lm(mpg ~ am, data=mtcars)
fitall<-lm(mpg ~ ., data=mtcars);vif(fitall)
fit9<-lm(mpg~cyl+hp+drat+wt+qsec+vs+am+gear+carb, data=mtcars);vif(fit9)
fit8<-lm(mpg~hp+drat+wt+qsec+vs+am+gear+carb, data=mtcars);vif(fit8)
fit7<-lm(mpg~drat+wt+qsec+vs+am+gear+carb, data=mtcars);vif(fit7)
anova(fit1,fit7, fit8, fit9,fitall)
summary(fit7)
fit7<-lm(mpg~drat+wt+qsec+vs+am+gear+carb, data=mtcars);vif(fit7)
fit8<-lm(mpg~hp+drat+wt+qsec+vs+am+gear+carb, data=mtcars);vif(fit8)
fit6<-lm(mpg~drat+qsec+vs+am+gear+carb, data=mtcars);vif(fit6)
anova(fit1,fit6,fit7, fit8, fit9,fitall)
fit6<-lm(mpg~drat+qsec+vs+am+gear+carb, data=mtcars);vif(fit6)
fit6<-lm(mpg~drat+wt+qsec+vs+am+carb, data=mtcars);vif(fit7)
anova(fit1,fit6,fit7, fit8, fit9,fitall)
fit6<-lm(mpg~drat+qsec+vs+am+gear+carb, data=mtcars);vif(fit6)
fit6<-lm(mpg~drat+wt+qsec+vs+am+carb, data=mtcars);vif(fit7)
fit6<-lm(mpg~drat+wt+qsec+vs+am+carb, data=mtcars);vif(fit7)
anova(fit1,fit6,fit7, fit8, fit9,fitall)
fit6<-lm(mpg~drat+wt+qsec+vs+am+carb, data=mtcars);vif(fit6)
anova(fit1,fit6,fit7, fit8, fit9,fitall)
fit5<-lm(mpg~drat+wt+vs+am+carb, data=mtcars);vif(fit5)
anova(fit1,fit5,fit6,fit7, fit8, fit9,fitall)
fit5<-lm(mpg~drat+wt+vs+am+carb, data=mtcars);vif(fit5)
fit4<-lm(mpg~wt+vs+am+carb, data=mtcars);vif(fit4)
anova(fit1,fit4, fit5,fit6,fit7, fit8, fit9,fitall)
summary(fit4)
summary(fit5)
fit4<-lm(mpg~wt+vs+am+carb, data=mtcars);vif(fit4)
fit5<-lm(mpg~drat+wt+vs+am+carb, data=mtcars);vif(fit5)
summary(fit5)
summary(fit4)
fit4<-lm(mpg~wt+vs+am+carb, data=mtcars);vif(fit4)
anova(fit1,fit4, fit5,fit6,fit7, fit8, fit9,fitall)
anova(fit1,fit4, fit5,fit6,fit7, fit8, fit9,fitall)
fit4<-lm(mpg~wt+vs+am+carb, data=mtcars);vif(fit4)
fit3<-lm(mpg~wt+vs+am, data=mtcars);vif(fit3)
anova(fit1,fit3,fit4, fit5,fit6,fit7, fit8, fit9,fitall)
fit4<-lm(mpg~wt+vs+am+carb, data=mtcars);vif(fit4)
fit3<-lm(mpg~am+wt+carb, data=mtcars);vif(fit3)
anova(fit1,fit3,fit4, fit5,fit6,fit7, fit8, fit9,fitall)
sumamry(fit4)
summary(fit4)
fit4<-lm(mpg~wt+vs+am+carb, data=mtcars);vif(fit4)
fit5<-lm(mpg~drat+wt+vs+am+carb, data=mtcars);vif(fit5)
fit4<-lm(mpg~drat+wt+am+carb, data=mtcars);vif(fit4)
fit6<-lm(mpg~drat+wt+qsec+vs+am+carb, data=mtcars);vif(fit6)
fit6<-lm(mpg~drat+wt+qsec+vs+am+carb, data=mtcars);vif(fit6)
fitn<-lm(mpg~am+drat+wt+qsec+vs+carb, data=mtcars)
summary(fitn)$coefficients
fitn<-lm(mpg~am+drat+wt+qsec+vs+carb, data=mtcars)
```{r,fig.height=8,fig.width=10}
par(mfrow = c(2, 2)); plot(fitn)
anova(fit1,fit6,fit7, fit8, fit9,fitall)
summary(fit6)
fit6<-lm(mpg~drat+qsec+vs+am+gear+carb, data=mtcars);vif(fit6)
anova(fit1,fit6,fit7, fit8, fit9,fitall)
fit6<-lm(mpg~drat+wt+qsec+vs+am+carb, data=mtcars);vif(fit6)
anova(fit1,fit6,fit7, fit8, fit9,fitall)
fit6<-lm(mpg~drat+wt+qsec+vs+am+carb, data=mtcars);vif(fit6)
fit5<-lm(mpg~drat+wt+vs+am+carb, data=mtcars);vif(fit5)
anova(fit1,fit5,fit6,fit7, fit8, fit9,fitall)
fit4<-lm(mpg~drat+wt+am+carb, data=mtcars);vif(fit4)
anova(fit1,fit5,fit6,fit7, fit8, fit9,fitall)
anova(fit1,fit4,fit5,fit6,fit7, fit8, fit9,fitall)
summary(fit4)
fit5<-lm(mpg~drat+wt+qsec+am+carb, data=mtcars);vif(fit5)
fit6<-lm(mpg~drat+wt+qsec+vs+am+carb, data=mtcars);vif(fit6)
fit5<-lm(mpg~drat+wt+qsec+am+carb, data=mtcars);vif(fit5)
anova(fit1,fit5,fit6,fit7, fit8, fit9,fitall)
summary(fit4)
summary(fit5)
summary(fit6)
fitn<-lm(mpg~am+drat+wt+vs+carb, data=mtcars)
shiny::runApp('D:/workspace/dataScientists/9-Developing Data Products/shiny/census-app')
load("D:/workspace/The Caltech-JPL Summer School on Big Data Analytics/Rdataset/XCO2.RData")
data(state)
statedata = data.frame(state.x77)
str(statedata)
statelm = lm(Life.Exp~., data=statedata)
summary(statelm)
?lm
statelm$residual
stateSSE = sum(statelm$residual^2)
stateSSE
summary(statelm)
statelm2 = lm(Life.Exp~Population+Murder+HS.Grad+Frost, data=statedata)
summary(statelm2)
stateSSE2 = sum(statelm2$residual^2)
stateSSE2
library(rpart)
library(rpart.plot)
stateTree = rpart(Life.Exp~., data=statedata)
plot(stateTree)
prp(stateTree)
?rpart
stateTree.pred = predict(stateTree)
stateTreeSSE = sum((stateTree.pred-statedata$Life.Exp)^2)
stateTreeSSE
?rpart
stateTree2 = rpart(Life.Exp~., data=statedata, minbucket=5)
prp(stateTree2)
stateTree2.pred = predict(stateTree2)
stateTree2SSE = sum((stateTree2.pred-statedata$Life.Exp)^2)
stateTree2SSE
stateTree3 = rpart(Life.Exp~Area, data=statedata, minbucket=1)
prp(stateTree3)
stateTree3.pred = predict(stateTree3)
stateTree3SSE = sum((stateTree3.pred-statedata$Life.Exp)^2)
stateTree3SSE
library(caret)
set.seed(111)
tr.control = trainControl(method = "cv", number = 10)
cp.grid = expand.grid( .cp = seq(0.01, 0.5, 0.01))
train(Life.Exp ~ ., data = statedata, method = "rpart", trControl = tr.control, tuneGrid = cp.grid)
stateTree4 = rpart(Life.Exp ~ ., data = statedata,cp=0.12)
prp(stateTree4)
stateTree4.pred = predict(stateTree4)
stateTree4.sse = sum((stateTree4.pred - statedata$Life.Exp)^2)
stateTree4.sse
set.seed(111)
train(Life.Exp ~ Area, data = statedata, method = "rpart", trControl = tr.control, tuneGrid = cp.grid)
stateTree5 = rpart(Life.Exp ~ Area, data = statedata,cp=0.02)
prp(stateTree5)
stateTree5.pred = predict(stateTree5)
stateTree5.sse = sum((stateTree5.pred - statedata$Life.Exp)^2)
stateTree5.sse
stateTree3SSE
setwd("D:/doc/study/TheAnalyticsEdge/unit6")
# 1.1
setwd("D:/doc/study/TheAnalyticsEdge/unit6")
airlines = read.csv("AirlinesCluster.csv")
getwd()
liberary(ggplot2)
library(ggplot2)
?stat_smooth
install.packages("gbm")
install.packages("glmnet")
install.packages('xgboost')
install.packages('xgboost')
devtools::install_github('tqchen/xgboost',subdir='R-pacakge')
devtools::install_github('tqchen/xgboost',subdir='R-pacakge')
devtools::install_github('tqchen/xgboost',subdir='R-pacakge')
install.packages("devtools")
devtools::install_github('tqchen/xgboost',subdir='R-pacakge')
setwd("D:/study/80240372XDataMining/ex/week2")
data <- read.csv("data.csv", stringsAsFactors=FALSE)
# 检查行数、列数
nrow(data)
ncol(data)
# 删除多余无用的列
data2<-data[1:38]
ncol(data)
table(data2$编号)
table(data2$性别)
hist(data2$性别)
plot(data2$性别)
data2<-data[1:38]
summary(data2$年龄)
table(data2$年龄)
hist(data2$性别)
hist(data2$年龄)
hist(data2$身高)
boxplot(data2$身高)
boxplot(性别~体重,data=data2)
boxplot(体重~性别,data=data2)
boxplot(身高~性别,data=data2)
boxplot(体重~性别,data=data2)
plot(data2$身高, data2$体重,col=data2$性别)
plot(data2$身高, data2$体重,col=data2$性别)
data2$性别 = as.factor(data2$性别)
plot(data2$性别)
boxplot(体重~性别,data=data2)
plot(data2$身高, data2$体重,col=data2$性别)
table(data2$性别)
hist(data2$年龄)
table(data2$年龄)
plot(身高~性别,data=data2,col=data2$性别)
plot(身高~年龄,data=data2,col=data2$性别)
boxplot(体重~性别,data=data2)
boxplot(体重~性别,data=data2,col=data2$性别)
plot(data2$身高, data2$体重,col=data2$性别)
summary(data2$标准体重)
table(data2$标准体重)
